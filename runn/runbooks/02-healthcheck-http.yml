desc: "02 â€” Health Check: HTTP endpoints (/healthz, /readyz, /health)"
runners:
  req: http://server-http:5001
steps:
  http_healthz:
    desc: "GET /healthz returns 200"
    req:
      /healthz:
        get:
          header:
            Accept: application/json
    test: |
      current.res.status == 200

  http_readyz:
    desc: "GET /readyz returns 200"
    req:
      /readyz:
        get:
          header:
            Accept: application/json
    test: |
      current.res.status == 200

  http_health:
    desc: "GET /health returns 200 with status"
    req:
      /health:
        get:
          header:
            Accept: application/json
    test: |
      current.res.status == 200

  http_health_service:
    desc: "GET /health?service=codebased.v1.CodeBasedService returns SERVING"
    req:
      /health?service=codebased.v1.CodeBasedService:
        get:
          header:
            Accept: application/json
    test: |
      current.res.status == 200

  http_health_unknown:
    desc: "GET /health?service=unknown returns 404"
    req:
      /health?service=unknown.v1.UnknownService:
        get:
          header:
            Accept: application/json
    test: |
      current.res.status == 404
